
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mungingdata.com/apache-spark/python-pyspark-scala-which-better/">
      
      
        <link rel="prev" href="../publishing-spark-projects-with-jitpack/">
      
      
        <link rel="next" href="../read-google-sheets-dataframe/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Scala Spark vs Python PySpark: Which is better? - MungingData</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scala-spark-vs-python-pyspark-which-is-better" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="MungingData" class="md-header__button md-logo" aria-label="MungingData" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MungingData
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Scala Spark vs Python PySpark: Which is better?
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="MungingData" class="md-nav__button md-logo" aria-label="MungingData" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    MungingData
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PySpark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            PySpark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/array-arraytype-list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Working with array columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/avoid-dots-periods-column-names/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Avoid periods in column names
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/chaining-dataframe-transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chaining transforms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/column-to-list-collect-tolocaliterator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column to list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/concat-array-union-except-intersect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Combining PySpark Arrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/constant-column-lit-typedlit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add constant column
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/dict-map-to-multiple-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dictionary to columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/exists-forall-any-all-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    exists and forall
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/filter-array/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter Array
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/install-delta-lake-jupyter-conda-mac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Delta, Jupyter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/poetry-dependency-management-wheel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Poetry Dependency management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/random-values-arrays-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Random array values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/rename-multiple-columns-todf-withcolumnrenamed/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rename columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/select-add-columns-withcolumn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Select columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/testing-pytest-chispa/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing PySpark
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/union-unionbyname-merge-dataframes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Union DataFrames
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/udf-dict-broadcast/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broadcast variables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/schema-structtype-structfield/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schema definition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/none-null/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None and NULL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyspark/sparksession-getorcreate-getactivesession/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark Session
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Apache Spark
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Apache Spark
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convert-csv-to-delta-lake-latency-trigger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convert CSV to Delta Lake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../broadcast-joins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broadcast joins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../broadcasting-maps-in-spark/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Broadcast maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../spark-3/array-exists-forall-transform-aggregate-zip_with/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Array methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arraytype-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scala array columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chaining-custom-dataframe-transformations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scala DataFrame transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../column-equality/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column equality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../column-methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Column methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compacting-parquet-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compacting Parquet files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../building-jar-sbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building JARs with SBT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe-schema-structfield-structtype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrame schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataframe-summary-describe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrame summary and describe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset-tods-createdataset-advantages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dates-times/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dates and Times
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dealing-with-null/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dealing with null
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deduplicating-and-collapsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deduplicating and collapsing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exact-percentile-approx-median/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Percentile and median
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment-specific-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Environment configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../best-books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Best books
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr-eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expr eval
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../just-enough-scala/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enough Scala
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limiting-function-order-dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Function order dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logistic-regressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logistic regression
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mill-build-tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mill build tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maptype-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MapType columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../optimizing-data-lakes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Optimizing data lakes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output-one-file-csv-parquet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output one file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partition-filters-pushed-filters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pushed filters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../partitionby/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partition by
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shading-dependencies-with-sbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shading dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../practical-introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Practical introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing-spark-projects-with-jitpack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publishing with jitpack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Pyspark vs Scala
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Pyspark vs Scala
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chaining-dataframe-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      Chaining DataFrame transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets-vs-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets vs DataFrames
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-parity" class="md-nav__link">
    <span class="md-ellipsis">
      Feature parity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Performance comparison
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-editing" class="md-nav__link">
    <span class="md-ellipsis">
      Code editing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compile-time-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Compile time exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      Code navigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-jars-vs-wheels" class="md-nav__link">
    <span class="md-ellipsis">
      Packaging JARs vs Wheels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scala-dependency-hell" class="md-nav__link">
    <span class="md-ellipsis">
      Scala dependency hell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-native-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Spark native functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udfs" class="md-nav__link">
    <span class="md-ellipsis">
      UDFs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topandas" class="md-nav__link">
    <span class="md-ellipsis">
      toPandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whitespace-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      Whitespace sensitivity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-safe-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Type safe programming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebook-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Notebook programming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Delta Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-open-source-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing open source projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../read-google-sheets-dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Real Google Sheets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../registerfunction-injectfunction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Register functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scala-packages-imports/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import packages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spark-sql-functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark SQL functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sparksession/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark Session
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../speaking-slack-notifications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Speak Slack notifications
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../start-end-month-last-day-date-trunc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start and end of month
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structured-streaming-trigger-once/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streaming Trigger Once
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testing-with-utest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing with utest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrate-to-spark-3-scala-2-12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrading to Spark 3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../using-the-console/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the console
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week-end-start-dayofweek-next-day/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start and end of week
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../expr-eval/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expr eval
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../filter-where/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter DataFrame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../frameless-typed-datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Frameless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hyperloglog-count-distinct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark HyperLogLog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../incrementally-updating-extracts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Incremental extracts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-to-dataframes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to DataFrames
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction-to-sbt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to SBT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced-string-matching-with-rlike/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rlike
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Aggregations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compacting-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compacting files
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DevRel
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            DevRel
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devrel/virtuous-content-cycle-developer-advocates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtuous Content Cycle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../devrel/devrel-driven-development/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DevRel Driven Development
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Python
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Python
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/dag-directed-acyclic-graph-networkx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building DAGs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/how-pyenv-works-shims/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How pyenv works
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/split-csv-write-chunk-pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Split CSV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/writing-parquet-pandas-pyspark-koalas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Parquet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python/jupyter-workflow-poetry-pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter and poetry
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Pandas
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Pandas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/dataframe-cut-category/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adding category column
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/large-data-workflow-dask/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Large data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/read-delta-lake-dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Delta Lake
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/read-multiple-csv-pandas-dataframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read multiple CSVs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/rename-columns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rename columns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pandas/unit-testing-pandas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unit testing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Golang
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Golang
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../go/csv-to-parquet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV to Parquet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../go/dataframes-gota-qframe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataFrames
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyArrow
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            PyArrow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyarrow/arbitrary-metadata-parquet-table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing Custom Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pyarrow/parquet-metadata-min-max-statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Parquet metadata
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Scala
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Scala
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/call-java-code-with-wrapper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Call Java with wrapper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/filesystem-paths-move-copy-list-delete-folders/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystem operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/library-best-practices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Library best practices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/maintenance-nightmare-upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maintenance nightmare
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/serializing-deserializing-case-classes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serde case classes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/testing-munit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing with munit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/scalate-templates-mustache-ssp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/scalatest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scalatest
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scala/read-write-json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read and write JSON
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/sdkman-multiple-versions-java-sbt-scala/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDKMAN installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../java/jenv-multiple-versions-java/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jenv
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Misc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unix/appending-executables-path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Appending Executables Path
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../oss/creating-open-source-software-is-a-delight/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open source is a delight
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aws/athena-spark-best-friends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spark and Athena
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../github/creating-ticketing-system-with-slack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a ticketing system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../creator/how-content-creators-make-lots-money/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creators making money
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../emacs/learning-emacs-keybindings-after-multiple-failed-attempts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Learn Emacs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../books/self-publishing-programming-books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Self publishing programming books
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../investing/ultra-cheap-real-estate-1000-square-meter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Investing in cheap real estate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../numpy/save-numpy-text-txt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    numpy Save to text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../career/7-steps-reject-meeting-zoom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manage calendar invites
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Delta Lake
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Delta Lake
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/merge-update-upserts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Merge, update, upserts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/compact-small-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compact small files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/type-2-scd-upserts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Type 2 SCD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/updating-partitions-with-replacewhere/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Updating partitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/vacuum-command/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vacuum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/schema-enforcement-evolution-mergeschema-overwriteschema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Schema enforcement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../delta-lake/introduction-time-travel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time travel
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    sqlite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            sqlite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlite/create-database-load-csv-python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create database Python
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlite/export-tables-queries-to-csv-parquet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Write to Parquet file
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dask
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Dask
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dask/write-csv-compression-filename/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compress CSVs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dask/ouput-dataframe-single-csv-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Output single file
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dask/software-environments-conda-miniconda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install with conda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dask/read-csv-to-parquet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CSV to Parquet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../dask/read-delta-lake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read Delta Lake
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chaining-dataframe-transformations" class="md-nav__link">
    <span class="md-ellipsis">
      Chaining DataFrame transformations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datasets-vs-dataframes" class="md-nav__link">
    <span class="md-ellipsis">
      Datasets vs DataFrames
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#feature-parity" class="md-nav__link">
    <span class="md-ellipsis">
      Feature parity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Performance comparison
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-editing" class="md-nav__link">
    <span class="md-ellipsis">
      Code editing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compile-time-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      Compile time exceptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-navigation" class="md-nav__link">
    <span class="md-ellipsis">
      Code navigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packaging-jars-vs-wheels" class="md-nav__link">
    <span class="md-ellipsis">
      Packaging JARs vs Wheels
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#scala-dependency-hell" class="md-nav__link">
    <span class="md-ellipsis">
      Scala dependency hell
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spark-native-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Spark native functions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#libraries" class="md-nav__link">
    <span class="md-ellipsis">
      Libraries
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#udfs" class="md-nav__link">
    <span class="md-ellipsis">
      UDFs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topandas" class="md-nav__link">
    <span class="md-ellipsis">
      toPandas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#whitespace-sensitivity" class="md-nav__link">
    <span class="md-ellipsis">
      Whitespace sensitivity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-safe-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Type safe programming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notebook-programming" class="md-nav__link">
    <span class="md-ellipsis">
      Notebook programming
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#delta-engine" class="md-nav__link">
    <span class="md-ellipsis">
      Delta Engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-open-source-projects" class="md-nav__link">
    <span class="md-ellipsis">
      Publishing open source projects
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="scala-spark-vs-python-pyspark-which-is-better">Scala Spark vs Python PySpark: Which is better?</h1>
<p>Apache Spark code can be written with the Scala, Java, Python, or R APIs.</p>
<p>Scala and Python are the most popular APIs. This blog post performs a detailed comparison of writing Spark with Scala and Python and helps users choose the language API that's best for their team.</p>
<p>Both language APIs are great options for most workflows. Spark lets you write elegant code to run jobs on massive datasets - it's an amazing technology.</p>
<p>Choosing the right language API is an important decision. It's hard to switch once you develop core libraries with one language.</p>
<p>Making the right choice is difficult because of common misconceptions like "Scala is 10x faster than Python", which are completely misleading when comparing Scala Spark and PySpark.</p>
<p>TL;DR:</p>
<ul>
<li>PySpark used to be buggy and poorly supported, but that's not true anymore. Python is a first class citizen in Spark. PySpark is a great option for most workflows.</li>
<li>More people are familiar with Python, so PySpark is naturally their first choice when using Spark.</li>
<li>Many programmers are terrified of Scala because of its reputation as a super-complex language. They don't know that Spark code can be written with basic Scala language features that you can learn in a day. You don't need to "learn Scala" or "learn functional programming" to write Spark code with Scala. You can stick to basic language features like <code>if</code>, <code>class</code>, and <code>object</code>, write code that looks exactly like Python, and enjoy the benefits of the Scala ecosystem.</li>
<li>Scala is a compile-time, type-safe language, so it offers certain features that cannot be offered in PySpark, like Datasets. Compile time checks give an awesome developer experience when working with an IDE like IntelliJ.</li>
<li>A lot of the Scala advantages don't matter in the Databricks notebook environment. Notebooks don't support features offered by IDEs or production grade code packagers, so if you're going to strictly work with notebooks, don't expect to benefit from Scala's advantages.</li>
<li>Python has great libraries, but most are not performant / unusable when run on a Spark cluster, so Python's "great library ecosystem" argument doesn't apply to PySpark (unless you're talking about libraries that you know are performant when run on clusters).</li>
</ul>
<p>Let's dig into the details and look at code to make the comparison more concrete.</p>
<h2 id="chaining-dataframe-transformations">Chaining DataFrame transformations</h2>
<p>This section demonstrates how the <code>transform</code> method can elegantly invoke Scala functions (because functions can take two parameter lists) and isn't quite as easy with Python.</p>
<p>Custom transformations are a great way to package Spark code. They're easily reusable and can be composed for different analyses. They're also easily testable as standalone units.</p>
<p>Suppose you have the following DataFrame.</p>
<pre><code>+--------+
| country|
+--------+
|  brasil|
|colombia|
|    null|
+--------+
</code></pre>
<p>Here's a Scala function that'll append some text to the <code>country</code> column:</p>
<pre><code>def funify(colName: String, str: String)(df: DataFrame): DataFrame = {
  df.withColumn(&quot;funified&quot;, concat(col(colName), lit(&quot; &quot;), lit(str)))
}
</code></pre>
<p>Here's how to invoke the Scala function with the <code>Dataset#transform</code> method:</p>
<pre><code>df
  .transform(funify(&quot;country&quot;, &quot;is awesome&quot;))
  .show()
</code></pre>
<pre><code>+--------+-------------------+
| country|           funified|
+--------+-------------------+
|  brasil|  brasil is awesome|
|colombia|colombia is awesome|
|    null|               null|
+--------+-------------------+
</code></pre>
<p>Notice how the <code>funify</code> function is defined with two parameter lists and invoked with one set of arguments. The Scala programming language allows for this elegant syntax.</p>
<p>Here's an equivalent PySpark function that'll append to the <code>country</code> column:</p>
<pre><code>from pyspark.sql.functions import col, lit, concat

def funify(col_name, str):
    def _(df):
        return df.withColumn(&quot;funified&quot;, concat(col(col_name), lit(&quot; &quot;), lit(str)))
    return _
</code></pre>
<p>Here's how to invoke the Python function with <code>DataFrame#transform</code>:</p>
<pre><code>df.transform(funify(&quot;country&quot;, &quot;is super fun!&quot;)).show(truncate=False)
</code></pre>
<pre><code>+--------+----------------------+
|country |funified              |
+--------+----------------------+
|colombia|colombia is super fun!|
|brasil  |brasil is super fun!  |
|null    |null                  |
+--------+----------------------+
</code></pre>
<p>There are <a href="https://mungingdata.com/pyspark/chaining-dataframe-transformations/">a lot of different ways to define custom PySpark transformations</a>, but nested functions seem to be the most popular.</p>
<p>Nested functions aren't the best. They create an extra level of indentation and require two return statements, which are easy to forget. The comparative difficulty of chaining PySpark custom transformations is a downside.</p>
<h2 id="datasets-vs-dataframes">Datasets vs DataFrames</h2>
<p>Datasets can only be implemented in languages that are compile-time type-safe. Java and Scala are compile-time type-safe, so they support Datasets, but Python and R are not compile-time type-safe, so they only support DataFrames.</p>
<p>Datasets so useful in practice.</p>
<ul>
<li>It's easy to perform operations <a href="https://mungingdata.com/apache-spark/dataset-tods-createdataset-advantages/">that'll convert a Dataset to a DataFrame</a> (e.g. adding a column).</li>
<li>Datasets <a href="https://stackoverflow.com/questions/40596638/spark-2-0-dataset-vs-dataframe/40602882#40602882">are less performant</a> although <a href="https://izeigerman.medium.com/making-the-spark-dataframe-composition-type-safe-r-7b6fed524ec2">the performance gap is supposedly narrowing</a></li>
<li><a href="https://github.com/typelevel/frameless/">Expressively typed Datasets</a> sound promising, but <a href="https://mungingdata.com/apache-spark/frameless-typed-datasets/">aren't practical yet</a></li>
</ul>
<p>Datasets shouldn't be considered to be a huge advantage because most Scala programmers use DataFrames anyways.</p>
<h2 id="feature-parity">Feature parity</h2>
<p>PySpark generally supports all the features in Scala Spark, with a few exceptions.</p>
<p>The <code>CalendarIntervalType</code> has been in the Scala API since Spark 1.5, but still isn't in the PySpark API as of Spark 3.0.1. This is a "serious loss of function" and <a href="https://github.com/apache/spark/pull/29935">will hopefully get added</a>.</p>
<p>In general, both the Python and Scala APIs support the same functionality. Spark knows that a lot of users avoid Scala/Java like the plague and they need to provide excellent Python support.</p>
<h2 id="performance-comparison">Performance comparison</h2>
<p>Scala and PySpark should perform relatively equally for DataFrame operations.</p>
<p><a href="https://stackoverflow.com/questions/32464122/spark-performance-for-scala-vs-python">This thread</a> has a dated performance comparison.</p>
<p><a href="https://news.ycombinator.com/item?id=26030970">"Regular" Scala code can run 10-20x faster than "regular" Python code</a>, but that PySpark isn't executed liked like regular Python code, so this performance comparison isn't relevant.</p>
<p>PySpark is converted to Spark SQL and then executed on a JVM cluster. It's not a traditional Python execution environment. Benchmarks for other Python execution environments are irrelevant for PySpark.</p>
<p>Watch out! Some other blog posts imply that PySpark is 10x slower which just isn't true.</p>
<h2 id="code-editing">Code editing</h2>
<p>The IntelliJ community edition provides a powerful Scala integrated development environment with out of the box. If provides you with code navigation, type hints, function completion, and compile-time runtime error reporting.</p>
<p>There's also a <a href="https://scalameta.org/metals/">Metals</a> project that allows for IDE-like text editor features in Vim or VSCode. Use IntelliJ if you'd like a full-serviced solution that works out of the box. Metals is good for those who enjoy text editor tinkering and custom setups.</p>
<p>Scala provides excellent text editors for working with Spark.</p>
<p>Some folks develop Scala code without the help of either Metals or IntelliJ, which puts you at a disadvantage. Scala IDEs give you a lot of help for free. Scala devs that reject free help from their text editor will suffer unnecessarily.</p>
<p>PyCharm doesn't work out of the box with PySpark, <a href="https://stackoverflow.com/questions/34685905/how-to-link-pycharm-with-pyspark">you need to configure it</a>. <a href="https://github.com/zero323/pyspark-stubs">pyspark-stubs</a> provide some nice error messages and autocompletion, but nothing compared to what's offered by Scala/IntelliJ.</p>
<p>Scala has the edge for the code editor battle.</p>
<h2 id="compile-time-exceptions">Compile time exceptions</h2>
<p>Here's what IntelliJ will show when you try to invoke a Spark method without enough arguments.</p>
<p><img alt="" src="../images/Screen-Shot-2021-02-08-at-10.12.54-AM-1024x148.png" /></p>
<p>The PyCharm error only shows up when pyspark-stubs is included and is more subtle.</p>
<p><img alt="" src="../images/Screen-Shot-2021-02-08-at-10.13.57-AM.png" /></p>
<p>At least you can hover over the method and get a descriptive hint.</p>
<p><img alt="" src="../images/Screen-Shot-2021-02-08-at-10.15.06-AM-1024x384.png" /></p>
<h2 id="code-navigation">Code navigation</h2>
<p>IntelliJ/Scala let you easily navigate from your code directly to the relevant parts of the underlying Spark code. Suppose your cursor is on the <code>regexp_extract</code> function. You can pretty Command + b to go directly to <code>org.apache.spark.sql.functions.regexp_extract</code> and then continue pressing Command + b to see exactly how the function is working under the hood.</p>
<p>PySpark code navigation is severely lacking in comparison. You can navigate to functions within your codebase, but you'll be directed to the stub file if you try to jump to the underlying PySpark implementations of core functions.</p>
<p>PySpark code navigation can't be as good due to Python language limitations.</p>
<h2 id="packaging-jars-vs-wheels">Packaging JARs vs Wheels</h2>
<p>Scala projects can be packaged as JAR files and uploaded to Spark execution environments like Databricks or EMR where the functions are invoked in production. JAR files can be assembled without dependencies (thin JAR files) or with dependencies (fat JAR files). Scala makes it easy to customize your fat JAR files to exclude the test dependencies, exclude Spark (because that's already included by your runtime), and contain other project dependencies. See <a href="https://mungingdata.com/apache-spark/building-jar-sbt/">this blog</a> for more on building JAR files.</p>
<p>You can even overwrite the packages for the dependencies in fat JAR files to avoid namespace conflicts by leveraging a process called shading.</p>
<p>Suppose <code>com.your.org.projectXYZ</code> depends on <code>com.your.org.projectABC</code> and you'd like to attach <code>projectXYZ</code> to a cluster as a fat JAR file. You'd like <code>projectXYZ</code> to use version 1 of <code>projectABC</code>, but would also like to attach version 2 of <code>projectABC</code> separately. When <code>projectXYZ</code> calls <code>com.your.org.projectABC.someFunction</code>, it should use version 1. All other invocations of <code>com.your.org.projectABC.someFunction</code> should use version 2.</p>
<p>You can shade <code>projectABC</code> in the <code>projectXYZ</code> fat JAR file, so the path is something like <code>projectAbcShaded.projectABC</code>, to prevent namespace conflicts for when <code>projectABC</code> version 2 is attached to the cluster. See <a href="https://mungingdata.com/apache-spark/shading-dependencies-with-sbt/">here</a> for more details on shading.</p>
<p>Shading is a great technique to avoid dependency conflicts and dependency hell.</p>
<p>Python doesn't support building fat wheel files or shading dependencies. This <a href="https://databricks.com/blog/2020/12/22/how-to-manage-python-dependencies-in-pyspark.html">blog post</a> explains some of the new ways to manage dependencies with Python and <a href="https://github.com/massmutual/sample-pyspark-application">this repo</a> shows how PySpark developers have managed dependencies historically. The PySpark solutions aren't as clean as fat JAR files, but are robust and improving nonetheless.</p>
<h2 id="scala-dependency-hell">Scala dependency hell</h2>
<p>Scala minor versions aren't binary compatible, so maintaining Scala projects is a lot of work. Scala 2.11 projects need to depend on projects that were also compiled with Scala 2.11.</p>
<p>It was even a lot of work for the Spark creators, Scala programming experts, <a href="https://issues.apache.org/jira/browse/SPARK-14220">to upgrade the Spark codebase from Scala 2.11 to 2.12</a>.</p>
<p>Scala codebase maintainers need to track the continuously evolving Scala requirements of Spark:</p>
<ul>
<li>Spark 2.3 apps needed to be compiled with Scala 2.11.</li>
<li>Spark 2.4 apps could be cross compiled with both Scala 2.11 and Scala 2.12.</li>
<li>Spark 3 apps only support Scala 2.12.</li>
</ul>
<p>Suppose you add a dependency to your project in Spark 2.3, like <a href="https://github.com/potix2/spark-google-spreadsheets">spark-google-spreadsheets</a>. The maintainer of this project stopped maintaining it and <a href="https://mvnrepository.com/artifact/com.github.potix2/spark-google-spreadsheets">there are no Scala 2.12 JAR files in Maven</a>. The spark-google-spreadsheets dependency would prevent you from cross compiling with Spark 2.4 and prevent you from upgrading to Spark 3 entirely.</p>
<p>You'd either need to upgrade spark-google-spreadsheets to Scala 2.12 and publish a package yourself or drop the dependency from your project to upgrade.</p>
<p>PySpark developers don't have the same dependency hell issues. A wheel file that's compiled with Python 3.6 will work on a Python 3.7 cluster. A wheel file that's compiled with Spark 2 will likely work on a Spark 3 cluster.</p>
<p>Scala should thoroughly vet dependencies and the associated transitive dependencies whenever evaluating a new library for their projects. Minimizing dependencies is the best way to sidestep dependency hell.</p>
<h2 id="spark-native-functions">Spark native functions</h2>
<p>The <code>org.apache.spark.sql.functions</code> are examples of Spark native functions. They're implemented in a manner that allows them to be optimized by Spark before they're executed.</p>
<p>The <code>pyspark.sql.functions</code> are mere wrappers that call the Scala functions under the hood.</p>
<p>Spark native functions need to be written in Scala.</p>
<p>Check out the itachi repo for <a href="https://github.com/yaooqinn/itachi">an example of a repo that contains a bunch of Spark native functions</a>.</p>
<p>You need to write Scala code if you'd like to write your own Spark native functions. The Spark maintainers <a href="https://github.com/apache/spark/pull/31346">are hesitant to expose the regexp_extract_all functions to the Scala API</a>, so I implemented it in <a href="https://github.com/MrPowers/bebe">the bebe project</a>.</p>
<p>You'll need to use Scala if you'd like to do this type of hacking. 75% of the Spark codebase is Scala code:</p>
<p><img alt="" src="../images/Screen-Shot-2021-02-07-at-9.14.00-PM.png" /></p>
<p>Most folks aren't interested in low level Spark programming. This advantage only counts for folks interested in digging in the weeds.</p>
<h2 id="libraries">Libraries</h2>
<p>Python has a great data science library ecosystem, some of which cannot be run on Spark clusters, others that are easy to horizontally scale.</p>
<ul>
<li>scikit-learn is an example of a lib that's not easily runnable on Spark</li>
<li><a href="https://jellyfish.readthedocs.io/en/latest/">jellyfish</a> can be easily wrapped in UDFs and run on Spark in a performant manner, see the <a href="https://github.com/MrPowers/ceja">ceja</a> project</li>
</ul>
<p>Just make sure that the Python libraries you love are actually runnable on PySpark when you're assessing the Python library ecosystem.</p>
<p>There is also a well-supported <a href="https://github.com/databricks/koalas">Koalas</a> project for folks that would like to write Spark code with Pandas syntax.</p>
<p>If you absolutely need a particular library, you can assess the support for both the Scala and PySpark APIs to aid your decision. For example, if you need Tensorflow at scale, you can compare <a href="https://github.com/yahoo/TensorFlowOnSpark">TensorFlowOnSpark</a> and <a href="https://github.com/eaplatanios/tensorflow_scala">tensorflow_scala</a> to aid your decision.</p>
<p>A lot of the popular Spark projects that were formerly Scala-only now offer Python APIs (e.g. <a href="https://github.com/JohnSnowLabs/spark-nlp">spark-nlp</a> and <a href="https://github.com/awslabs/python-deequ">python-deequ</a>).</p>
<p>Neither library ecosystem is clearly favored. It depends on your specific needs.</p>
<h2 id="udfs">UDFs</h2>
<p>UDFs should be avoided whenever possible, with either language API, because they're a black box for the compiler and can't be optimized.</p>
<p>UDFs are also a frequent cause of NullPointerExceptions. Make sure you always test the null input case when writing a UDF.</p>
<p>You should always try to solve your problem with the functions exposed in <code>org.apache.spark.sql.functions</code> or <code>pyspark.sql.functions</code> before falling back to UDFs.</p>
<p>Both Python and Scala allow for UDFs when the Spark native functions aren't sufficient.</p>
<p><a href="https://databricks.com/blog/2017/10/30/introducing-vectorized-udfs-for-pyspark.html">Pandas UDFs (aka vectorized UDFs)</a> are marketed as a cool feature, but they're really an anti-pattern that should be avoided, so don't consider them a PySpark plus.</p>
<h2 id="topandas">toPandas</h2>
<p>PySpark DataFrames can be converted to Pandas DataFrames with <code>toPandas</code>. This collects all the data on the driver node and negates all the parallelism benefits of regular PySpark DataFrames.</p>
<p>Spark DataFrames are spread across a cluster and computations run in parallel - that's why Spark is so fast - it's a cluster computing framework.</p>
<p>You throw all the benefits of cluster computing out the window when converting a Spark DataFrame to a Pandas DataFrame. All the data is transferred to the driver node. Subsequent operations run on the Pandas DataFrame will only use the computational power of the driver node.</p>
<p>The driver node usually isn't big enough for all the data, so calling <code>toPandas</code> often results in an out of memory exception.</p>
<p><code>toPandas</code> might be useful at times, but it probably causes more harm than good. Newbies try to convert their Spark DataFrames to Pandas so they can work with a familiar API and don't realize that it'll crash their job or make it run a lot slower. Use <a href="https://github.com/databricks/koalas">koalas</a> if you'd like to write Spark code with Pandas syntax.</p>
<p><code>toPandas</code> is <a href="https://mungingdata.com/pyspark/column-to-list-collect-tolocaliterator/">the fastest way to convert a DataFrame column to a list</a>, but that's another example of an antipattern that commonly results in an OutOfMemory exception.</p>
<p><code>toPandas</code> shouldn't be considered a PySpark advantage. Write out a Parquet file and read it in to a Pandas DataFrame using a different computation box if that's your desired workflow. You don't need a heavyweight Spark JVM cluster to work with Pandas.</p>
<h2 id="whitespace-sensitivity">Whitespace sensitivity</h2>
<p>Python's whitespace sensitivity causes ugly PySpark code when backslash continuation is used.</p>
<p>Here's an example from the <a href="https://github.com/awslabs/python-deequ">python-deequ</a> README:</p>
<pre><code>checkResult = VerificationSuite(spark) \
    .onData(df) \
    .addCheck(
        check.hasSize(lambda x: x &gt;= 3) \
        .hasMin(&quot;b&quot;, lambda x: x == 0) \
        .isComplete(&quot;c&quot;)  \
        .isUnique(&quot;a&quot;)  \
        .isContainedIn(&quot;a&quot;, [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;]) \
        .isNonNegative(&quot;b&quot;)) \
    .run()
</code></pre>
<p>Backslash continuation is frowned upon in the Python community, but you'll still see it in the wild.</p>
<p>The equivalent Scala code looks nicer without all the backslashes:</p>
<pre><code>val verificationResult = VerificationSuite()
  .onData(data)
  .addCheck(
    Check(CheckLevel.Error, &quot;unit testing my data&quot;)
      .hasSize(_ == 5)
      .isComplete(&quot;id&quot;)
      .isUnique(&quot;id&quot;)
      .isComplete(&quot;productName&quot;)
      .isContainedIn(&quot;priority&quot;, Array(&quot;high&quot;, &quot;low&quot;))
      .isNonNegative(&quot;numViews&quot;)
    .run()
</code></pre>
<p>You can avoid the Python backslashes by wrapping the code block in parens:</p>
<pre><code>spark = (SparkSession
    .builder
    .config(&quot;spark.jars.packages&quot;, pydeequ.deequ_maven_coord)
    .config(&quot;spark.jars.excludes&quot;, pydeequ.f2j_maven_coord)
    .getOrCreate())
</code></pre>
<p>Spark encourages a long method change style of programming so Python whitespace sensitivity is annoying.</p>
<h2 id="type-safe-programming">Type safe programming</h2>
<p>Scala is a compile-time, type-safe language and offers type safety benefits that are useful in the big data space.</p>
<p>Suppose your project has a small bug and contains a method that takes three parameters, but is only invoked with two arguments. Scala will throw a compile-time error and not allow you to build the JAR file to make a production deploy.</p>
<p>Small bugs can be really annoying in big data apps. Your job might run for 5 hours before your small bug crops up and ruins the entire job run.</p>
<p>Python doesn't have any similar compile-time type checks. Python will happily build a wheel file for you, even if there is a three parameter method that's run with two arguments.</p>
<p>There are different ways to write Scala <a href="https://www.lihaoyi.com/post/StrategicScalaStylePracticalTypeSafety.html">that provide more or less type safety</a>. Spark is on the less type safe side of the type safety spectrum.</p>
<ul>
<li>Column objects are basically untyped</li>
<li>Datasets aren't that practical to use</li>
<li>Type casting is a core design practice to make Spark work</li>
</ul>
<p>Type safety has the potential to be a huge advantage of the Scala API, but it's not quite there at the moment. I'm working on a project called <a href="https://github.com/MrPowers/bebe">bebe</a> that'll hopefully provide the community with a performant, type safe Scala programming interface.</p>
<h2 id="notebook-programming">Notebook programming</h2>
<p>Some of the costs / benefits we've discussed thus far don't carry over to the notebook environment.</p>
<p>For example, Scala allows for compile time checks and IDEs will highlight invalid code. Databricks notebooks don't support this feature. This particular Scala advantage over PySpark doesn't matter if you're only writing code in Databricks notebooks.</p>
<p>Databricks notebooks are good for exploratory data analyses, but shouldn't be overused for production jobs.</p>
<p>The code for production jobs should live in version controlled GitHub repos, which are packaged as wheels / JARs and attached to clusters. Databricks notebooks should provide a thin wrapper around the package that invokes the relevant functions for the job.</p>
<h2 id="delta-engine">Delta Engine</h2>
<p>Databricks is developing a proprietary Spark runtime called Delta Engine that's written in C++.</p>
<p>Delta Engine will provide Scala &amp; Python APIs. One of the main Scala advantages at the moment is that it's the language of Spark. This advantage will be negated if Delta Engine becomes the most popular Spark runtime.</p>
<p>The Delta Engine source code is private. That'll make navigating to internals and seeing how things work under the hood impossible, in any language. That'll also make it impossible for other players to release Delta Engine based runtimes.</p>
<p>The existence of Delta Engine makes the future of Spark unclear.</p>
<p>Delta Lake, another Databricks product, started private and eventually succumbed to pressure and became free &amp; open source. It's possible Delta Engine will become open source and the future of hardcore Spark hacking will be C++.</p>
<h2 id="publishing-open-source-projects">Publishing open source projects</h2>
<p>Publishing open source Scala projects to Maven is a pain.</p>
<ul>
<li>You need to open a JIRA ticket to create your Maven namespace (not kidding)</li>
<li>Wait for a couple of days for them to respond to the JIRA ticket</li>
<li>You need to create a GPG key and upload the public key to a keyserver</li>
<li>Actually publishing requires a separate SBT plugin (SBT plugin maintenance / version hell is a thing too!)</li>
</ul>
<p>Every time you run the publish command, you need to remember the password for your GPG key.</p>
<p>Publishing open source Python projects to PyPi is much easier. You run the publishing command, enter your username / password, and the wheel is uploaded, pretty much instantaneously. The Poetry dependency management tool provides the <code>poetry publish</code> tool out of the box, so you don't need to deal with the Python equivalent of a SBT plugin.</p>
<p>Python open source publishing is a joy compared to Scala.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Spark is an awesome framework and the Scala and Python APIs are both great for most workflows.</p>
<p>PySpark is more popular because Python is the most popular language in the data community.</p>
<p>PySpark is a well supported, first class Spark API, and is a great choice for most organizations.</p>
<p>Scala is a powerful programming language that offers developer friendly features that aren't available in Python. You can use basic Scala programming features with the IntelliJ IDE and get useful features like type hints and compile time checks for free.</p>
<p>Scala offers a lot of advance programming features, but you don't need to use any of them when writing Spark code. Complex Spark data processing frameworks can be built with basic Scala language features like <code>object</code>, <code>if</code>, and functions.</p>
<p>Scala is also great for lower level Spark programming and easy navigation directly to the underlying source code.</p>
<p>Scala gets a lot of hate and many developers are terrified to even try working with the language. Their aversion of the language is partially justified. Scala allows certain developers to get out of line and write code that's really hard to read. Sidenote: Spark codebase is a great example of well written Scala that's easy to follow.</p>
<p>The best language for your organization will depend on your particular team. Platforms like Databricks make it easy to write jobs in both languages, but that's not a realistic choice for most companies. Once core libraries are developed in one language, then all subsequent jobs are forced to use the chosen language to avoid rework.</p>
<p>Choosing the right language API is important. Think and experiment extensively before making the final decision!</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../publishing-spark-projects-with-jitpack/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Publishing with jitpack">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Publishing with jitpack
              </div>
            </div>
          </a>
        
        
          
          <a href="../read-google-sheets-dataframe/" class="md-footer__link md-footer__link--next" aria-label="Next: Real Google Sheets">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Real Google Sheets
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.copy", "navigation.footer", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>